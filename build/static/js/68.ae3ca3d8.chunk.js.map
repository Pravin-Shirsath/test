{"version":3,"sources":["Routes/dashboard/rechargeModal/index.js"],"names":["Recharge","props","useHistory","useState","loading","setRecharge","filteredRecharges","selectedPlan","setSelectedPlan","additionalspace","setAdditionalspace","amountTotal","setAmountTotal","JSON","parse","localStorage","getItem","couponText","setCouponText","discount","setDiscount","CoupanDiscount","useEffect","RechargePlan","accessToken","GetRechargedPlan","then","res","status","data","results","undefined","length","console","log","catch","err","response","discount_type","discount_value","parseInt","NotificationManager","error","calculate","DiscountCheck","PaybleAmount","className","name","content","title","id","match","map","item","i","colClasses","fullBlock","subscription_name","per_gb_rate","type","value","onChange","e","isNaN","parseFloat","Total","AddspceEvent","target","onClick","CuponValidCheck","setItem","stringify","Success","key","hasOwnProperty","color","style","display","justifyContent","alignItems","padding"],"mappings":"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","file":"static/js/68.ae3ca3d8.chunk.js","sourcesContent":["import \"./recharge.css\"\n\n/**\n * User Management Page\n */\nimport React, { useEffect, useState, useRef } from 'react'\nimport { Helmet } from 'react-helmet'\n\nimport { Link, useHistory } from 'react-router-dom';\n\n// page title bar\nimport PageTitleBar from '../../../Components/PageTitleBar/PageTitleBar'\n// intl messages\nimport IntlMessages from '../../../Util/IntlMessages'\n// rct card box\nimport RctCollapsibleCard from '../../../Components/RctCollapsibleCard/RctCollapsibleCard'\n// rct section loader\nimport RctSectionLoader from '../../../Components/RctSectionLoader/RctSectionLoader'\nimport '../../../Assets/css/user.css'\n\nimport {\n  Progress, Button,\n  Form,\n  FormGroup,\n  Label,\n  Input,\n  FormText,\n  Col,\n  FormFeedback, CustomInput\n} from 'reactstrap';\nimport { CuponValidCheck, GetRechargedPlan } from \"Api\";\nimport { NotificationManager } from 'react-notifications'\n\nexport default function Recharge(props) {\n  const history = useHistory();\n\n  const [loading, setLoading] = useState(false)\n  const [recharge, setRecharge] = useState([])\n  const [filteredRecharges, setFilteredRecharges] = useState([])\n  const [totalPageCount, setTotalPageCount] = useState(0)\n  const [selectedPlan, setSelectedPlan] = useState(null)\n\n  const [additionalspace, setAdditionalspace] = useState(0)\n  const [paybleAmount, setPaybleAmount] = useState(0)\n\n  // amount total is calculation space * per gb rate\n  const [amountTotal, setAmountTotal] = useState(0)\n  const [couponText, setCouponText] = useState(JSON.parse(localStorage.getItem(\"Couponcode\")) || \"\")\n  const [discount, setDiscount] = useState(0)\n  const [CoupanDiscount, setCouponDiscount] = useState(JSON.parse(localStorage.getItem(\"Discount\")) || { \"discount_value\": 0, \"discount_type\": \"\" })\n\n\n\n\n  useEffect(() => {\n    const isLoggedInBool = localStorage.getItem(\"isLoggedIn\")\n    RechargePlan()\n  }, [])\n\n\n\n\n  const RechargePlan = () => {\n    const accessToken = JSON.parse(localStorage.getItem('token'))\n    if (accessToken !== null) {\n      GetRechargedPlan(accessToken, 1)\n        .then((res) => {\n          if (res?.status === 200) {\n            if (res?.data?.results) {\n              if (res?.data?.results != undefined) {\n                if (res?.data?.results.length == 1) {\n                  setSelectedPlan(res?.data?.results[0])\n                }\n              }\n            }\n\n            setRecharge(res?.data?.results);\n            console.log('Response fromRecharged list :', res)\n\n          } else {\n            console.log('Response from fromRecharged:', res)\n          }\n        })\n        .catch((err) => {\n          // console.log(\"status of invalid token\", err?.response?.data, err?.response?.status)\n          if (err?.response?.status == 401) {\n\n          } else {\n            // console.log('Response from customerlist:', err)\n          }\n        })\n    }\n  }\n\n\n\n  const DiscountCheck=()=>{\n    if (CoupanDiscount.discount_type === \"\") {\n      setDiscount(0)\n\n    } else if (CoupanDiscount.discount_type === \"amount\") {\n\n      if (CoupanDiscount.discount_value <= amountTotal) {\n        setDiscount(parseInt(CoupanDiscount.discount_value))\n\n      } else {\n        setDiscount(0)\n        if(amountTotal != 0){\n\n          NotificationManager.error(`coupon can not be applied below ${parseInt(CoupanDiscount.discount_value)} rupees`);\n        }\n      }\n    } else if (CoupanDiscount.discount_type == \"percentage\") {\n\n      if (amountTotal != 0) {\n        let calculate = parseInt(amountTotal) * (parseInt(CoupanDiscount.discount_value) / 100)\n        setDiscount(calculate)\n\n      } else {\n        setDiscount(0)\n       \n\n      }\n\n\n\n    }\n\n  }\n\n  useEffect(()=>{\n    DiscountCheck()\n  },[amountTotal])\n\n\n  const AddspceEvent = (e) => {\n    console.log(e, typeof (e), isNaN(e))\n\n    /** if  AddSpace input value Nan or \" \" handle  and calculate amount handle*/\n    if (!isNaN(e) || e === '') {\n\n      let Value = parseFloat(e);\n      if (Value < 0) {\n        setAmountTotal(0)\n        setAdditionalspace(0)\n        NotificationManager.error(\"Value cannot be negative. Please enter a valid Value.\");\n        console.log(\"\");\n      } else {\n        setAdditionalspace(e)\n\n      }\n      /** if  selected pland is or default selllected plan is available pergb rate and add space calculation set*/\n\n      if (selectedPlan) {\n        let Total = (parseInt(e) * parseInt(selectedPlan?.per_gb_rate))\n        console.log(Total, \"total\")\n        if (!isNaN(Total)) {\n          setAmountTotal(parseInt(Total))\n        } else {\n          setAmountTotal(0)\n        }\n      }\n\n      /** if  Discount check */\n\n    \n\n    }\n\n  }\n\n\n\n\n  const CopanApplay = () => {\n    const accessToken = JSON.parse(localStorage.getItem('token'))\n    if (couponText != \"\") {\n      if (accessToken !== null) {\n\n\n        CuponValidCheck(accessToken, couponText)\n          .then((res) => {\n            console.log(\"coupan=\", res)\n            if (res?.status === 200) {\n              if (res?.data?.[0]) {\n                localStorage.setItem(\"Discount\", JSON.stringify(res?.data?.[0]))\n                localStorage.setItem(\"Couponcode\", JSON.stringify(couponText))\n                NotificationManager.Success(\"Copon Apply\");\n              }\n            } else {\n              console.log('Response from fromRecharged:', res)\n            }\n          })\n          .catch((err) => {\n            console.log('Response from customerlist:', err)\n            // console.log(\"status of invalid token\", err?.response?.data, err?.response?.status)\n\n            if (err?.response?.status === 403 || err?.response?.status === 400) {\n              if (err?.response?.data) {\n                let data = err?.response?.data\n                for (var key in data) {\n                  if (data.hasOwnProperty(key)) {\n                    NotificationManager.error(data[key]);\n\n                  }\n                }\n\n              }\n            }\n\n\n\n            if (err?.response?.status == 401) {\n              // conditional rendring\n              // localStorage.clear();\n              // history.push(\"/login\");\n              // window.location.reload();\n            } else {\n              // console.log('Response from customerlist:', err)\n            }\n          })\n      }\n    } else {\n      NotificationManager.error(\"Coupon code is empty\");\n\n    }\n  }\n\n\n    const  PaybleAmount =()=>{\n     if(amountTotal >= discount){\n      return parseInt(amountTotal)- parseInt(discount)\n\n     }else{\n       \n       return parseInt(amountTotal)\n     }\n\n    }\n\n\n\n  return (\n    <div className=\"user-management\">\n      <Helmet>\n        <title>Automaton | Customers List</title>\n        <meta name=\"description\" content=\"Automaton Widgets\" />\n      </Helmet>\n      <PageTitleBar\n        title={<IntlMessages id=\"sidebar.recharge\" />}\n        match={props.match}\n      />\n    \n\n\n\n      <div className=\"row \">\n        {filteredRecharges &&\n          filteredRecharges.map((item, i) => {\n\n\n            return <RctCollapsibleCard\n\n              colClasses=\"col-sm-12 col-md-3 col-lg-3  rounded\"\n\n              fullBlock\n              key={i}\n            >\n              <div className=\"shadow project-card-shadow\">\n                <section className=\"bg-primary text-white px-3 shadow rounded d-flex  align-items-center py-3 \">\n                  <div className=\"ml-4  align-items-center \">\n\n                    <h2 className=\"\">{item?.subscription_name} </h2>\n                    <h3>{item.per_gb_rate} ₹ / GB </h3>\n                  </div>\n                </section>\n\n\n              </div>\n\n            </RctCollapsibleCard>\n          })\n        }\n\n\n      </div>\n\n\n      <RctCollapsibleCard fullBlock>\n        <div className=\"table-responsive dark-primary-text\">\n          <div className='rechargeBoxContainer'>\n            <div className=\"heading dark-primary\">\n              <h1>Recharge</h1>\n            </div>\n\n            <div className=\"firstRow recharge-modal-row light-primary\">\n              <div className=\"left\">\n                <p className=\"wrapper\"><p className=\"text\">Additional Space</p> <p className=\"inputMaterial\"><input type=\"number\" value={additionalspace} onChange={(e) => AddspceEvent(e.target.value)} /> GB <span className=\"diff\">@{selectedPlan?.per_gb_rate} ₹ / GB</span></p></p>\n              </div>\n\n              <div className=\"mid\"><p>=</p></div>\n\n              <div className=\"right\"><p>{amountTotal} ₹</p></div>\n            </div>\n\n            <div className=\"secondRow recharge-modal-row light-primary\">\n              <div className=\"left\">\n                <p><span className=\"inputContainer\"><input value={couponText} onChange={(e) => setCouponText(e.target.value)} /></span> <Button onClick={CopanApplay} color=\"primary\" style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}>Apply Coupon</Button></p>\n              </div>\n\n              <div className=\"mid\">\n                <p>=</p>\n              </div>\n\n              <div className=\"right\"><p><span className=\"operator\">-</span>{discount} ₹</p></div>\n            </div>\n\n            <div className=\"thirdRow recharge-modal-row light-primary\">\n              <div className=\"left\"></div>\n\n              <div className=\"mid\"></div>\n\n              <div className=\"right\">\n                <p> {PaybleAmount()} ₹</p>\n              </div>\n            </div>\n\n            <div className=\"fourthRow recharge-modal-row light-primary\">\n              <p>\n                Net Payable <span>{PaybleAmount()} ₹</span>\n              </p>\n            </div>\n\n            <div className=\"fifthRow recharge-modal-row light-primary\">\n              <p>\n                <Button color=\"primary\" style={{ padding: \"10px 50px\" }}>Proceed To Checkout</Button>\n              </p>\n            </div>\n          </div>\n        </div>\n        {loading && <RctSectionLoader />}\n      </RctCollapsibleCard>\n    </div>\n  )\n}\n"],"sourceRoot":""}