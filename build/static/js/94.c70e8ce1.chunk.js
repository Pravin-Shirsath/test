(this.webpackJsonpreactify=this.webpackJsonpreactify||[]).push([[94],{1564:function(e,t,r){"use strict";var n=r(38);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(371)),o=r(0),i=(0,a.default)((0,o.jsx)("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");t.default=i},2451:function(e,t,r){"use strict";var n=r(11),a=r(55),o=r(49),i=r(19),s=r(20),u=r(3),l=r(16),c=r(31),p=r(10),d=r(9),f=r(102),h=r(108),b=r(131),v=r(169),y=r(170),m=r(116),O=r(106),j=globalThis.AbortController,k=(globalThis.AbortSignal,function(e,t){void 0===e&&(e="Aborted");var r=new DOMException(e,"AbortError");return null!=t&&Object(O.a)(t,"cause")&&Object.defineProperty(r,"cause",{__proto__:null,configurable:!0,writable:!0,value:t.cause}),r});function w(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var g=0;function P(e){return"__private_"+g+++"_"+e}var x=1048576,U={getChunkSize:function(e){return Math.ceil(e.size/1e4)},onProgress:function(){},onPartComplete:function(){},onSuccess:function(){},onError:function(e){throw e}};var E=Symbol("pausing upload, not an actual error"),S=P("abortController"),C=P("chunks"),R=P("chunkState"),M=P("data"),F=P("file"),T=P("uploadPromise"),I=P("onError"),z=P("onSuccess"),L=P("onReject"),A=P("initChunks"),q=P("createUpload"),H=P("resumeUpload"),N=P("onPartProgress"),_=P("onPartComplete"),B=P("abortUpload");function D(){var e=this.options.getChunkSize(w(this,M)[M]),t=w(this,M)[M].size,r=Math.max(5*x,Math.ceil(t/1e4)),n=Math.max(e,r);if(0===w(this,M)[M].size)w(this,C)[C]=[w(this,M)[M]],w(this,M)[M].onProgress=w(this,N)[N](0),w(this,M)[M].onComplete=w(this,_)[_](0);else{var a=Math.ceil(t/n);w(this,C)[C]=Array(a);for(var o=0,i=0;i<t;i+=n){var s=Math.min(t,i+n),u=w(this,M)[M].slice(i,s);u.onProgress=w(this,N)[N](o),u.onComplete=w(this,_)[_](o),w(this,C)[C][o++]=u}}w(this,R)[R]=w(this,C)[C].map((function(){return{uploaded:0}}))}function J(){w(this,T)[T]=this.options.companionComm.uploadFile(w(this,F)[F],w(this,C)[C],w(this,S)[S].signal).then(w(this,z)[z],w(this,L)[L])}function Q(){w(this,T)[T]=this.options.companionComm.resumeUploadFile(w(this,F)[F],w(this,C)[C],w(this,S)[S].signal).then(w(this,z)[z],w(this,L)[L])}function W(){var e=this;w(this,S)[S].abort(),this.options.companionComm.abortFileUpload(w(this,F)[F]).catch((function(t){return e.options.log(t)}))}var V,X=function(){function e(t,r){var n,a=this;Object(p.a)(this,e),Object.defineProperty(this,B,{value:W}),Object.defineProperty(this,H,{value:Q}),Object.defineProperty(this,q,{value:J}),Object.defineProperty(this,A,{value:D}),Object.defineProperty(this,S,{writable:!0,value:new j}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:function(e){return(null==e?void 0:e.cause)===E?null:w(a,I)[I](e)}}),Object.defineProperty(this,N,{writable:!0,value:function(e){return function(t){if(t.lengthComputable){var r=t.loaded;w(a,R)[R][e].uploaded=function(e){if("string"===typeof e)return parseInt(e,10);if("number"===typeof e)return e;throw new TypeError("Expected a number")}(r);var n=w(a,R)[R].reduce((function(e,t){return e+t.uploaded}),0);a.options.onProgress(n,w(a,M)[M].size)}}}}),Object.defineProperty(this,_,{writable:!0,value:function(e){return function(t){w(a,C)[C][e]=null,w(a,R)[R][e].etag=t,w(a,R)[R][e].done=!0;var r={PartNumber:e+1,ETag:t};a.options.onPartComplete(r)}}}),this.options=Object(u.a)(Object(u.a)({},U),r),null!=(n=this.options).getChunkSize||(n.getChunkSize=U.getChunkSize),w(this,M)[M]=t,w(this,F)[F]=r.file,w(this,z)[z]=this.options.onSuccess,w(this,I)[I]=this.options.onError,w(this,A)[A]()}return Object(d.a)(e,[{key:"start",value:function(){w(this,T)[T]?(w(this,S)[S].signal.aborted||w(this,S)[S].abort(E),w(this,S)[S]=new j,w(this,H)[H]()):w(this,q)[q]()}},{key:"pause",value:function(){w(this,S)[S].abort(E),w(this,S)[S]=new j}},{key:"abort",value:function(e){var t;void 0===e&&(e=void 0),null!=(t=e)&&t.really?w(this,B)[B]():this.pause()}},{key:"chunkState",get:function(){return w(this,R)[R]}}]),e}();function G(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var K=0;function Y(e){return"__private_"+K+++"_"+e}function Z(e){if(e&&e.error){var t=new Error(e.message);throw Object.assign(t,e.error),t}return e}function $(e){if(null!=e&&e.aborted)throw k("The operation was aborted",{cause:e.reason})}var ee=Y("abortMultipartUpload"),te=Y("cache"),re=Y("createMultipartUpload"),ne=Y("fetchSignature"),ae=Y("listParts"),oe=Y("previousRetryDelay"),ie=Y("requests"),se=Y("retryDelayIterator"),ue=Y("sendCompletionRequest"),le=Y("setS3MultipartState"),ce=Y("uploadPartBytes"),pe=Y("shouldRetry"),de=function(){function e(t,r,n){Object(p.a)(this,e),Object.defineProperty(this,pe,{value:fe}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),Object.defineProperty(this,te,{writable:!0,value:new WeakMap}),Object.defineProperty(this,re,{writable:!0,value:void 0}),Object.defineProperty(this,ne,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),Object.defineProperty(this,oe,{writable:!0,value:void 0}),Object.defineProperty(this,ie,{writable:!0,value:void 0}),Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:void 0}),Object.defineProperty(this,ce,{writable:!0,value:void 0}),G(this,ie)[ie]=t,G(this,le)[le]=n,this.setOptions(r)}return Object(d.a)(e,[{key:"setOptions",value:function(e){var t,r=G(this,ie)[ie];("abortMultipartUpload"in e&&(G(this,ee)[ee]=r.wrapPromiseFunction(e.abortMultipartUpload)),"createMultipartUpload"in e&&(G(this,re)[re]=r.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&(G(this,ne)[ne]=r.wrapPromiseFunction(e.signPart)),"listParts"in e&&(G(this,ae)[ae]=r.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&(G(this,ue)[ue]=r.wrapPromiseFunction(e.completeMultipartUpload)),"retryDelays"in e)&&(G(this,se)[se]=null==(t=e.retryDelays)?void 0:t.values());"uploadPartBytes"in e&&(G(this,ce)[ce]=r.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0}))}},{key:"getUploadId",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t,r){var n,a,o,i=this;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=G(this,te)[te].get(t.data))){e.next=3;break}return e.abrupt("return",n);case 3:return a=G(this,re)[re](t,r),o=function(){a.abort(r.reason),G(i,te)[te].delete(t.data)},r.addEventListener("abort",o,{once:!0}),G(this,te)[te].set(t.data,a),a.then(function(){var e=Object(c.a)(Object(l.a)().mark((function e(n){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.removeEventListener("abort",o),G(i,le)[le](t,n),G(i,te)[te].set(t.data,n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(){r.removeEventListener("abort",o)})),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"abortFileUpload",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t){var r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=G(this,te)[te].get(t.data))){e.next=10;break}return e.t0=G(this,ee),e.t1=ee,e.t2=t,e.next=7,r;case 7:return e.t3=e.sent,e.next=10,e.t0[e.t1].call(e.t0,e.t2,e.t3);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadFile",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t,r,n){var a,o,i,s,u=this;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(n),e.next=3,this.getUploadId(t,n);case 3:return a=e.sent,o=a.uploadId,i=a.key,$(n),e.next=9,Promise.all(r.map((function(e,r){return u.uploadChunk(t,r+1,e,n)})));case 9:return s=e.sent,$(n),e.abrupt("return",G(this,ue)[ue](t,{key:i,uploadId:o,parts:s,signal:n}).abortOn(n));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"resumeUploadFile",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t,r,n){var a,o,i,s,u,c=this;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(n),e.next=3,this.getUploadId(t,n);case 3:return a=e.sent,o=a.uploadId,i=a.key,$(n),e.next=9,G(this,ae)[ae](t,{uploadId:o,key:i,signal:n}).abortOn(n);case 9:return s=e.sent,$(n),e.next=13,Promise.all(r.map((function(e,r){var a=r+1,o=s.find((function(e){return e.PartNumber===a}));return null==o?c.uploadChunk(t,a,e,n):{PartNumber:a,ETag:o.ETag}})));case 13:return u=e.sent,$(n),e.abrupt("return",G(this,ue)[ue](t,{key:i,uploadId:o,parts:u,signal:n}).abortOn(n));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"uploadChunk",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t,r,n,a){var o,i,s,c;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(a),e.next=3,this.getUploadId(t,a);case 3:o=e.sent,i=o.uploadId,s=o.key,$(a);case 7:return e.next=9,G(this,ne)[ne](t,{uploadId:i,key:s,partNumber:r,body:n,signal:a}).abortOn(a);case 9:return c=e.sent,$(a),e.prev=11,e.t0=u.a,e.t1={PartNumber:r},e.next=16,G(this,ce)[ce](c,n,a).abortOn(a);case 16:return e.t2=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 20:return e.prev=20,e.t3=e.catch(11),e.next=24,G(this,pe)[pe](e.t3);case 24:if(e.sent){e.next=26;break}throw e.t3;case 26:e.next=7;break;case 28:case"end":return e.stop()}}),e,this,[[11,20]])})));return function(t,r,n,a){return e.apply(this,arguments)}}()}]),e}();function fe(e){return he.apply(this,arguments)}function he(){return(he=Object(c.a)(Object(l.a)().mark((function e(t){var r,n,a,o,i,s,u,c,p,d=this;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=G(this,ie)[ie],null!=(a=null==t||null==(r=t.source)?void 0:r.status)){e.next=4;break}return e.abrupt("return",!1);case 4:if(403!==a||"Request has expired"!==t.message){e.next=16;break}if(n.isPaused){e.next=14;break}if(1!==n.limit&&null!=G(this,oe)[oe]){e.next=11;break}if(null!=(i=null==(o=G(this,se)[se])?void 0:o.next())&&!i.done){e.next=10;break}return e.abrupt("return",!1);case 10:G(this,oe)[oe]=i.value;case 11:return n.rateLimit(0),e.next=14,new Promise((function(e){return setTimeout(e,G(d,oe)[oe])}));case 14:e.next=37;break;case 16:if(429!==a){e.next=24;break}if(n.isPaused){e.next=22;break}if(null!=(u=null==(s=G(this,se)[se])?void 0:s.next())&&!u.done){e.next=21;break}return e.abrupt("return",!1);case 21:n.rateLimit(u.value);case 22:e.next=37;break;case 24:if(!(a>400&&a<500&&409!==a)){e.next=28;break}return e.abrupt("return",!1);case 28:if("undefined"===typeof navigator||!1!==navigator.onLine){e.next=32;break}n.isPaused||(n.pause(),window.addEventListener("online",(function(){n.resume()}),{once:!0})),e.next=37;break;case 32:if(null!=(p=null==(c=G(this,se)[se])?void 0:c.next())&&!p.done){e.next=35;break}return e.abrupt("return",!1);case 35:return e.next=37,new Promise((function(e){return setTimeout(e,p.value)}));case 37:return e.abrupt("return",!0);case 38:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var be=Y("queueRequestSocketToken"),ve=Y("companionCommunicationQueue"),ye=Y("client"),me=Y("setS3MultipartState"),Oe=Y("requestSocketToken"),je=Y("setCompanionHeaders");V=Symbol.for("uppy test: getClient");var ke=function(e,t){Object(i.a)(f,e);var r=Object(s.a)(f);function f(e,t){var a,o;Object(p.a)(this,f),a=r.call(this,e,t),Object.defineProperty(Object(n.a)(a),be,{writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(a),ve,{writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(a),ye,{writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(a),me,{writable:!0,value:function(e,t){var r=t.key,n=t.uploadId,o=a.uppy.getFile(e.id);a.uppy.setFileState(e.id,{s3Multipart:Object(u.a)(Object(u.a)({},o.s3Multipart),{},{key:r,uploadId:n})})}}),Object.defineProperty(Object(n.a)(a),Oe,{writable:!0,value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t){var r,n,o,i;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.remote.providerOptions.provider?h.a:h.b,n=new r(a.uppy,t.remote.providerOptions),o=Object(u.a)({},a.opts),t.tus&&Object.assign(o,t.tus),null!=t.remote.url){e.next=6;break}throw new Error("Cannot connect to an undefined URL");case 6:return e.next=8,n.post(t.remote.url,Object(u.a)(Object(u.a)({},t.remote.body),{},{protocol:"s3-multipart",size:t.data.size,metadata:t.meta}));case 8:return i=e.sent,e.abrupt("return",i.token);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(Object(n.a)(a),je,{writable:!0,value:function(){G(Object(n.a)(a),ye)[ye].setCompanionHeaders(a.opts.companionHeaders)}}),a.type="uploader",a.id=a.opts.id||"AwsS3Multipart",a.title="AWS S3 Multipart",G(Object(n.a)(a),ye)[ye]=new h.b(e,t);var i={allowedMetaFields:null,limit:6,retryDelays:[0,1e3,3e3,5e3],createMultipartUpload:a.createMultipartUpload.bind(Object(n.a)(a)),listParts:a.listParts.bind(Object(n.a)(a)),abortMultipartUpload:a.abortMultipartUpload.bind(Object(n.a)(a)),completeMultipartUpload:a.completeMultipartUpload.bind(Object(n.a)(a)),signPart:a.signPart.bind(Object(n.a)(a)),uploadPartBytes:f.uploadPartBytes,companionHeaders:{}};return a.opts=Object(u.a)(Object(u.a)({},i),t),null!=(null==t?void 0:t.prepareUploadParts)&&null==t.signPart&&(a.opts.signPart=function(){var e=Object(c.a)(Object(l.a)().mark((function e(r,n){var a,o,i,s,u,c,p,d;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.uploadId,o=n.key,i=n.partNumber,s=n.body,u=n.signal,e.next=3,t.prepareUploadParts(r,{uploadId:a,key:o,parts:[{number:i,chunk:s}],signal:u});case 3:return c=e.sent,p=c.presignedUrls,d=c.headers,e.abrupt("return",{url:null==p?void 0:p[i],headers:null==d?void 0:d[i]});case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),a.upload=a.upload.bind(Object(n.a)(a)),a.requests=null!=(o=a.opts.rateLimitedQueue)?o:new m.a(a.opts.limit),G(Object(n.a)(a),ve)[ve]=new de(a.requests,a.opts,G(Object(n.a)(a),me)[me]),a.uploaders=Object.create(null),a.uploaderEvents=Object.create(null),a.uploaderSockets=Object.create(null),G(Object(n.a)(a),be)[be]=a.requests.wrapPromiseFunction(G(Object(n.a)(a),Oe)[Oe],{priority:-1}),a}return Object(d.a)(f,[{key:t,value:function(){return G(this,ye)[ye]}},{key:"setOptions",value:function(e){return G(this,ve)[ve].setOptions(e),Object(a.a)(Object(o.a)(f.prototype),"setOptions",this).call(this,e)}},{key:"resetUploaderReferences",value:function(e,t){void 0===t&&(t={}),this.uploaders[e]&&(this.uploaders[e].abort({really:t.abort||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)}},{key:"assertHost",value:function(e){if(!this.opts.companionUrl)throw new Error("Expected a `companionUrl` option containing a Companion address, or if you are not using Companion, a custom `".concat(e,"` implementation."))}},{key:"createMultipartUpload",value:function(e,t){var r;this.assertHost("createMultipartUpload"),$(t);var n=e.meta?Object.fromEntries((null!=(r=this.opts.allowedMetaFields)?r:Object.keys(e.meta)).filter((function(t){return null!=e.meta[t]})).map((function(t){return[t,String(e.meta[t])]}))):{};return G(this,ye)[ye].post("s3/multipart",{filename:e.name,type:e.type,metadata:n},{signal:t}).then(Z)}},{key:"listParts",value:function(e,t,r){var n=t.key,a=t.uploadId;this.assertHost("listParts"),$(r);var o=encodeURIComponent(n);return G(this,ye)[ye].get("s3/multipart/".concat(a,"?key=").concat(o),{signal:r}).then(Z)}},{key:"completeMultipartUpload",value:function(e,t,r){var n=t.key,a=t.uploadId,o=t.parts;this.assertHost("completeMultipartUpload"),$(r);var i=encodeURIComponent(n),s=encodeURIComponent(a);return G(this,ye)[ye].post("s3/multipart/".concat(s,"/complete?key=").concat(i),{parts:o},{signal:r}).then(Z)}},{key:"signPart",value:function(e,t){var r=t.uploadId,n=t.key,a=t.partNumber,o=t.signal;if(this.assertHost("signPart"),$(o),null==r||null==n||null==a)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");var i=encodeURIComponent(n);return G(this,ye)[ye].get("s3/multipart/".concat(r,"/").concat(a,"?key=").concat(i),{signal:o}).then(Z)}},{key:"abortMultipartUpload",value:function(e,t,r){var n=t.key,a=t.uploadId;this.assertHost("abortMultipartUpload");var o=encodeURIComponent(n),i=encodeURIComponent(a);return G(this,ye)[ye].delete("s3/multipart/".concat(i,"?key=").concat(o),void 0,{signal:r}).then(Z)}},{key:"uploadFile",value:function(e){var t=this,r=this;return new Promise((function(n,a){var o=new X(e.data,Object(u.a)({companionComm:G(t,ve)[ve],log:function(){var e;return(e=r.uppy).log.apply(e,arguments)},getChunkSize:t.opts.getChunkSize?t.opts.getChunkSize.bind(t):null,onProgress:function(r,n){t.uppy.emit("upload-progress",e,{uploader:t,bytesUploaded:r,bytesTotal:n})},onError:function(r){t.uppy.log(r),t.uppy.emit("upload-error",e,r),t.resetUploaderReferences(e.id),a(r)},onSuccess:function(r){var a=o,i={body:Object(u.a)({},r),uploadURL:r.location};t.resetUploaderReferences(e.id);var s=t.uppy.getFile(e.id);t.uppy.emit("upload-success",s||e,i),r.location&&t.uppy.log("Download ".concat(e.name," from ").concat(r.location)),n(a)},onPartComplete:function(r){var n=t.uppy.getFile(e.id);n&&t.uppy.emit("s3-multipart:part-uploaded",n,r)},file:e},e.s3Multipart));t.uploaders[e.id]=o,t.uploaderEvents[e.id]=new b.a(t.uppy),t.onFileRemove(e.id,(function(r){o.abort(),t.resetUploaderReferences(e.id,{abort:!0}),n("upload ".concat(r.id," was removed"))})),t.onCancelAll(e.id,(function(t){"user"===(void 0===t?{}:t).reason&&(o.abort(),r.resetUploaderReferences(e.id,{abort:!0})),n("upload ".concat(e.id," was canceled"))})),t.onFilePause(e.id,(function(e){e?o.pause():o.start()})),t.onPauseAll(e.id,(function(){o.pause()})),t.onResumeAll(e.id,(function(){o.start()})),e.progress.uploadStarted&&e.isRestored||(o.start(),t.uppy.emit("upload-started",e))}))}},{key:"uploadRemote",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t){var r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.resetUploaderReferences(t.id),t.progress.uploadStarted&&t.isRestored||this.uppy.emit("upload-started",t),e.prev=2,!t.serverToken){e.next=7;break}return e.next=6,this.connectToServerSocket(t);case 6:case 15:return e.abrupt("return",e.sent);case 7:return e.next=9,G(this,be)[be](t);case 9:if(r=e.sent,this.uppy.getState().files[t.id]){e.next=12;break}return e.abrupt("return",void 0);case 12:return this.uppy.setFileState(t.id,{serverToken:r}),e.next=15,this.connectToServerSocket(this.uppy.getFile(t.id));case 18:throw e.prev=18,e.t0=e.catch(2),this.uppy.setFileState(t.id,{serverToken:void 0}),this.uppy.emit("upload-error",t,e.t0),e.t0;case 23:case"end":return e.stop()}}),e,this,[[2,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"connectToServerSocket",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t){var r,n=this;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,e.abrupt("return",new Promise((function(e,a){var o,i=t.serverToken,s=Object(y.a)(t.remote.companionUrl),u=new h.c({target:"".concat(s,"/api/").concat(i),autoOpen:!1});n.uploaderSockets[t.id]=u,n.uploaderEvents[t.id]=new b.a(n.uppy),n.onFileRemove(t.id,(function(){o.abort(),u.send("cancel",{}),n.resetUploaderReferences(t.id,{abort:!0}),e("upload ".concat(t.id," was removed"))})),n.onFilePause(t.id,(function(e){e?(o.abort(),u.send("pause",{})):(o.abort(),o=n.requests.run((function(){return u.open(),u.send("resume",{}),function(){return u.close()}})))})),n.onPauseAll(t.id,(function(){o.abort(),u.send("pause",{})})),n.onCancelAll(t.id,(function(n){"user"===(void 0===n?{}:n).reason&&(o.abort(),u.send("cancel",{}),r.resetUploaderReferences(t.id)),e("upload ".concat(t.id," was canceled"))})),n.onResumeAll(t.id,(function(){o.abort(),t.error&&u.send("pause",{}),o=n.requests.run((function(){return u.open(),u.send("resume",{}),function(){return u.close()}}))})),n.onRetry(t.id,(function(){u.isOpen&&(u.send("pause",{}),u.send("resume",{}))})),n.onRetryAll(t.id,(function(){u.isOpen&&(u.send("pause",{}),u.send("resume",{}))})),u.on("progress",(function(e){return Object(v.a)(n,e,t)})),u.on("error",(function(e){n.uppy.emit("upload-error",t,new Error(e.error)),n.resetUploaderReferences(t.id),o.done(),a(new Error(e.error))})),u.on("success",(function(r){var a={uploadURL:r.url};n.uppy.emit("upload-success",t,a),n.resetUploaderReferences(t.id),o.done(),e()})),o=n.requests.run((function(){return t.isPaused?u.send("pause",{}):u.open(),function(){return u.close()}}))})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t){var r,n=this;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",void 0);case 2:return r=t.map((function(e){var t=n.uppy.getFile(e);return t.isRemote?n.uploadRemote(t):n.uploadFile(t)})),e.abrupt("return",Promise.all(r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onFileRemove",value:function(e,t){this.uploaderEvents[e].on("file-removed",(function(r){e===r.id&&t(r.id)}))}},{key:"onFilePause",value:function(e,t){this.uploaderEvents[e].on("upload-pause",(function(r,n){e===r&&t(n)}))}},{key:"onRetry",value:function(e,t){this.uploaderEvents[e].on("upload-retry",(function(r){e===r&&t()}))}},{key:"onRetryAll",value:function(e,t){var r=this;this.uploaderEvents[e].on("retry-all",(function(){r.uppy.getFile(e)&&t()}))}},{key:"onPauseAll",value:function(e,t){var r=this;this.uploaderEvents[e].on("pause-all",(function(){r.uppy.getFile(e)&&t()}))}},{key:"onCancelAll",value:function(e,t){var r=this;this.uploaderEvents[e].on("cancel-all",(function(){r.uppy.getFile(e)&&t.apply(void 0,arguments)}))}},{key:"onResumeAll",value:function(e,t){var r=this;this.uploaderEvents[e].on("resume-all",(function(){r.uppy.getFile(e)&&t()}))}},{key:"install",value:function(){var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:Object(u.a)(Object(u.a)({},e),{},{resumableUploads:!0})}),this.uppy.addPreProcessor(G(this,je)[je]),this.uppy.addUploader(this.upload)}},{key:"uninstall",value:function(){var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:Object(u.a)(Object(u.a)({},e),{},{resumableUploads:!1})}),this.uppy.removePreProcessor(G(this,je)[je]),this.uppy.removeUploader(this.upload)}}],[{key:"uploadPartBytes",value:function(){var e=Object(c.a)(Object(l.a)().mark((function e(t,r,n){var a,o,i;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.url,o=t.expires,i=t.headers,$(n),null!=a){e.next=4;break}throw new Error("Cannot upload to an undefined URL");case 4:return e.abrupt("return",new Promise((function(e,t){var s=new XMLHttpRequest;function u(){s.abort()}function l(){n.removeEventListener("abort",u)}s.open("PUT",a,!0),i&&Object.keys(i).forEach((function(e){s.setRequestHeader(e,i[e])})),s.responseType="text","number"===typeof o&&(s.timeout=1e3*o),n.addEventListener("abort",u),s.upload.addEventListener("progress",r.onProgress),s.addEventListener("abort",(function(){l(),t(k())})),s.addEventListener("timeout",(function(){l();var e=new Error("Request has expired");e.source={status:403},t(e)})),s.addEventListener("load",(function(n){if(l(),403===n.target.status&&n.target.responseText.includes("<Message>Request has expired</Message>")){var a=new Error("Request has expired");return a.source=n.target,void t(a)}if(n.target.status<200||n.target.status>=300){var o=new Error("Non 2xx");return o.source=n.target,void t(o)}null==r.onProgress||r.onProgress(r.size);var i=n.target.getResponseHeader("ETag");null!==i?(null==r.onComplete||r.onComplete(i),e({ETag:i})):t(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."))})),s.addEventListener("error",(function(e){l();var r=new Error("Unknown error");r.source=e.target,t(r)})),s.send(r)})));case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),f}(f.a,V);ke.VERSION="3.1.3"},709:function(e,t,r){"use strict";var n=r(5),a=r(26),o=r(1),i=r.n(o),s=r(2),u=r.n(s),l=r(14),c=r.n(l),p=r(13),d=["className","cssModule","widths","tag"],f=u.a.oneOfType([u.a.number,u.a.string]),h=u.a.oneOfType([u.a.bool,u.a.number,u.a.string,u.a.shape({size:u.a.oneOfType([u.a.bool,u.a.number,u.a.string]),order:f,offset:f})]),b={tag:p.o,xs:h,sm:h,md:h,lg:h,xl:h,className:u.a.string,cssModule:u.a.object,widths:u.a.array},v={tag:"div",widths:["xs","sm","md","lg","xl"]},y=function(e,t,r){return!0===r||""===r?e?"col":"col-"+t:"auto"===r?e?"col-auto":"col-"+t+"-auto":e?"col-"+r:"col-"+t+"-"+r},m=function(e){var t=e.className,r=e.cssModule,o=e.widths,s=e.tag,u=Object(a.a)(e,d),l=[];o.forEach((function(t,n){var a=e[t];if(delete u[t],a||""===a){var o=!n;if(Object(p.i)(a)){var i,s=o?"-":"-"+t+"-",d=y(o,t,a.size);l.push(Object(p.k)(c()(((i={})[d]=a.size||""===a.size,i["order"+s+a.order]=a.order||0===a.order,i["offset"+s+a.offset]=a.offset||0===a.offset,i)),r))}else{var f=y(o,t,a);l.push(f)}}})),l.length||l.push("col");var f=Object(p.k)(c()(t,l),r);return i.a.createElement(s,Object(n.a)({},u,{className:f}))};m.propTypes=b,m.defaultProps=v,t.a=m}}]);
//# sourceMappingURL=94.c70e8ce1.chunk.js.map